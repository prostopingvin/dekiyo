# Simple-discord.db
It is a simple library that can automatically save / check out / modify the saved data of the discord user.
The entire file structure is created in the root directory and stores guilds, users, members and other data in a separate file. 
## Usage 
Connect the library as 
```
const DiscordDB = require('simple-discord.db');
Client.Memory = new DiscordDB("name", Client);
```
To have access to it through the bot client. The `name` will determine which DB will be connected. Next, you should perform the initial configuration (performed once).
```
await Client.Memory.create(); //Creates initial files for memory 
Client.Memory.setAutoStart(Boolean); //Whether the memory will start automatically when a config is detected (without preliminary configuration) 
Client.Memory.setBackUp(time); //Sets the time for saving backups and turns them on 
Client.Memory.setAutoSave(time); //Sets the autosave memory time and turns it on 
Client.Memory.setGuilds(guildScheme); //Sets the function for creating guilds 
Client.Memory.setUsers(userScheme); //Sets the function for creating users 
Client.Memory.setMembers(memberDataScheme); //Sets the function for creating members 
Client.Memory.save(); //Preserves memory 
```
`guildScheme` and other schemas are simple functions that create data for memory from Discord elements. Such a function must be prepared for the fact that this very element will not be passed to it.
**Example:**
```
const guildScheme = (guild = {id: "123", ownerId: "123"}) => {
    return {
        id: guild.id, //Each circuit must always have an ID 
        ownerId: guild.ownerId,
        members: {} //Guild must have members
    }
}
Client.Memory.setGuilds(guildScheme);
```
As a guild must have `members`, `members` must have a `guildId` inside for memory to work. 
These sections of memory can be accessed as `Memory.guilds.get(id)`. In response, you receive data about the `guild`. 
The guild itself, like all data inside the memory, has the following keys: 
```
const guild = Memory.guilds.get("899200433552252989");
guild.clearData; //Retrieves a copy of the guild data 
//or
Memory.guilds.clearData; //Retrieves a copy of all guild data in memory 
guild.cache; //Gets this guild's discord cache 
guild.add(message.guild) //Manual Adding Guild to Memory
await guild.fetch(); //Searches for this guild in discord
guild.update(key); //Refreshes / resets a specific tuning key to the default (specified by the schema) 
//or
Memory.guilds.update(key); //Refreshes / resets a specific key for all guilds in memory 
```
All parameters of the database can be configured manually through the config in the folder of this database 
**Example:**
```
{
	"autoStart": true, //Autostart memory 
	"autoAdd": true, //Auto add servers and users
	"autoStartSchems": {},
	"backUp": {
		"enable": true, //Backups included
		"time": 3600000, //Every hour 
		"count": 2 //Have at least 2 backups 
	},
	"autoSave": {
		"enable": true, //Autosave memory 
		"lastRefresh": 1637793860575, //Last save time 
		"time": 3600000 //Save interval 
	}
}
```
If you do not use `"autoAdd": false` you need to write manual addition.An example of adding used in db:
```
Client.on('messageCreate', message => {
	if(message.guild) {
		if(!Memory.guilds.get(message.guild.id)) Memory.guilds.add(message.guild);
		const memGuild = Memory.guilds.get(message.guild.id,false);
		if(!memGuild.members.get(message.author.id)&&message.member) memGuild.members.add(message.member);
		if(!Memory.users.get(message.author.id)&&message.author) Memory.users.add(message.author);
	}
});
```
## More details
You can output settings data to the console via `Memory.console`, but if you want to output data not to the console, but in a simple text format, use `Memory.consoleClear`.
### Updating schemas
When using `new DiscordDB("name", Client)`, you can transfer an object with schema functions or go to your DB directory in the Schemes folder and change the functions there.

To change the schema when connecting, an object with functions is declared. 
**Example:**
```
const newSchemes = {
	guilds: functions,
	users: functions,
	memers: functions
}
new DiscordDB("name", Client, newSchemes)
```
## Iterator
You can always call enumeration functions on `guilds`, `users` and `members` objects. 
Returns the actual value of the content.
```
for (const iterator of Memory.guilds) {
	console.log(iterator);
}
```